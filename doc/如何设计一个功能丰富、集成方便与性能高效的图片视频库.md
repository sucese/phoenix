# å¦‚ä½•è®¾è®¡ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œã€é›†æˆæ–¹ä¾¿ä¸æ€§èƒ½é«˜æ•ˆçš„å›¾ç‰‡è§†é¢‘åº“

å›¾ç‰‡/è§†é¢‘åº“æ˜¯æ¯ä¸ªå…¬å¸éƒ½ä¼šé‡åˆ°çš„ä¸šåŠ¡åœºæ™¯ï¼Œæ‰€è®¾è®¡çš„åŠŸèƒ½ä¹Ÿéƒ½å¤§è‡´ç›¸åŒï¼Œå›¾ç‰‡/è§†é¢‘é€‰æ‹©ã€å‹ç¼©ã€ç¼–è¾‘ã€ä¸Šä¼ ç­‰ï¼Œä½†æ˜¯ç”±äºä¸åŒä¸šåŠ¡å¯¹åŠŸèƒ½çš„éœ€æ±‚ä¸åŒï¼ŒåŠ ä¹‹
å›¾ç‰‡/è§†é¢‘çš„å‹ç¼©ä¸Šä¼ å¤„ç†æœ‰æ€§èƒ½å’Œå…¼å®¹æ€§é—®é¢˜ï¼Œå¯¼è‡´åšå¥½ä¸€ä¸ªå›¾ç‰‡/è§†é¢‘åº“æ˜¯ä¸å®¹æ˜“çš„ã€‚

é‚£ä¹ˆä»€ä¹ˆæ ·çš„å›¾ç‰‡/è§†é¢‘åº“æ˜¯é€šç”¨ã€ç®€å•ä¸”é«˜æ•ˆçš„å‘¢ï¼ŸğŸ¤”

æˆ‘æƒ³ä¸»è¦çš„è®¾è®¡åŸåˆ™æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

- åŠŸèƒ½çš„ç‹¬ç«‹æ€§ï¼šåŠŸèƒ½çš„å®ç°ç¬¦åˆå®šä¹‰çš„æ¥å£è§„èŒƒï¼Œå„ä¸ªåŠŸèƒ½å½¼æ­¤ç‹¬ç«‹ï¼Œäº’ä¸ä¾èµ–ï¼Œæ—¢å¯å•ç‹¬è°ƒç”¨ï¼Œä¹Ÿå¯ç»„åˆè°ƒç”¨ã€‚
- ç•Œé¢çš„å®šåˆ¶æ€§ï¼šç»„ä»¶å†…æä¾›å¯¹åº”å„ä¸ªappçš„ä¸»é¢˜ï¼Œæ–¹ä¾¿å„ä¸ªappå¿«é€Ÿæ¥å…¥å¼€å‘ï¼Œå¹¶æä¾›å®šåˆ¶UIçš„æ–¹æ³•ã€‚
- è°ƒç”¨çš„ä¾¿åˆ©æ€§ï¼šå¼€å¯æŸä¸ªåŠŸèƒ½åªéœ€è¦è°ƒç”¨enableXXX(true)æ–¹æ³•ï¼Œç»“æœç»Ÿä¸€è·å–ã€‚
- å¤šç«¯çš„æ”¯æŒæ€§ï¼šä¸ºnativeã€h5ä¸react nativeæä¾›è°ƒç”¨æ–¹å¼ã€‚

## ä¸€ æ¶æ„å›¾è®¾è®¡

âˆš<img src="https://github.com/guoxiaoxing/phoenix/raw/master/art/phoenix_structure.png"/>

æ³¨ï¼šæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯ç‹¬ç«‹åˆ†å¼€çš„ï¼Œå¯ä»¥å•ç‹¬è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥ç»„åˆè°ƒç”¨ã€‚

## äºŒ æ•°æ®ç»“æ„ä¸æ¥å£è®¾è®¡

### 2.1 æ•°æ®ç»“æ„

å›¾ç‰‡/è§†é¢‘é‡‡ç”¨ç»Ÿä¸€Modelæ¥è¡¨ç¤ºï¼ŒåŒ…å«å›¾ç‰‡/è§†é¢‘çš„åŸºæœ¬ä¿¡æ¯ï¼Œä¹ŸåŒ…å«å¤„ç†åçš„ç»“æœã€‚

```java
/**
 * æ–‡ä»¶ä¿¡æ¯ç±»ï¼Œæä¾›äº†setter/getterä¸builderä¸¤ç§åˆ›å»ºæ–¹å¼
 */
public class MediaEntity implements Serializable, Parcelable{

    private static final long serialVersionUID = 1L;

    public static final int STATE_NOT_UPLOAD = 0;
    public static final int STATE_UPLOAD_ING = 1;
    public static final int STATE_UPLOAD_FAIL = 2;
    public static final int STATE_UPLOAD_SUCCESS = 3;

    //æ–‡ä»¶ç±»å‹
    private int fileType;
    //mimeç±»å‹
    private String mimeType;
    //æ–‡ä»¶åç§°
    private String mediaName;
    //åˆ›å»ºæ—¶é—´ï¼Œå•ä½æ¯«ç§’
    private long createTime;
    //æœ¬åœ°åœ°å€
    private String localPath;
    //ç¼©ç•¥å›¾åœ°å€
    private String localThumbnailPath;
    //æ—¶é•¿ï¼Œå•ä½æ¯«ç§’
    private long duration;
    //æ˜¯å¦é€‰ä¸­
    private boolean isChecked;
    //ç´¢å¼•
    public int position;
    //æ•°é‡
    private int number;
    //å®½åº¦
    private int width;
    //é«˜åº¦
    private int height;
    //ç»åº¦
    private String latitude;
    //çº¬åº¦
    private String longitude;

    //aliyunUpload
    //ä¸Šä¼ çŠ¶æ€
    private int isUploaded;
    //æœåŠ¡å™¨åœ°å€
    private String onlinePath;

    //compress
    //æ˜¯å¦å‹ç¼©
    private boolean isCompressed;
    //å‹ç¼©ååœ°å€
    private String compressPath;

    //crop
    //å‰ªåˆ‡ååœ°å€
    private String cutPath;
    //
    private int cropOffsetX;
    //
    private int cropOffsetY;
    //
    private int cropWidth;
    //
    private int cropHeight;
    //
    private float cropAspectRatio;
    //æ˜¯å¦å‰ªåˆ‡
    private boolean isCut;
}
```

## æ¥å£è®¾è®¡

ç¼–è¾‘ã€å‹ç¼©ä¸ä¸Šä¼ ç­‰æ“ä½œç»Ÿä¸€æ¥å£ã€‚

```java
public interface OnProcessorListener {

    /**
     * Call when operation start
     *
     * @param originList originList
     */
    void onProcessStart(List<MediaEntity> originList);

    /**
     * Call when operation success
     *
     * @param processList processList
     */
    void onProcessSuccess(List<MediaEntity> processList);

    /**
     * Call when operation failed
     *
     * @param errorMessage errorMessage
     */
    void onFailed(String errorMessage);
}
```

## æ€§èƒ½ä¼˜åŒ–è®¾è®¡

å›¾ç‰‡/è§†é¢‘åº“é¢ä¸´çš„æœ€å¤§çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯å›¾ç‰‡/è§†é¢‘å‹ç¼©çš„æ•ˆç‡å’Œå…¼å®¹æ€§é—®é¢˜ï¼Œå°¤å…¶æ˜¯å¯¹äºè§†é¢‘è€Œè¨€ï¼Œè½¯è§£å‹ç¼©çš„æ•ˆç‡æ…¢çš„éš¾ä»¥è®©äººå¿å—ã€‚æ‰€ä»¥å¯¹äº
è§†é¢‘è€Œè¨€ï¼Œæˆ‘ä»¬é‡‡å–çš„è¿˜æ˜¯ç¡¬è§£å‹ç¼©ã€‚